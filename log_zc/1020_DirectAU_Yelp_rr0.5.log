command line args [--zc 0.5] will not be used in RecBole
20 Oct 20:44    INFO  
General Hyper Parameters:
gpu_id = 3
use_gpu = True
seed = 0
state = INFO
reproducibility = True
data_path = dataset/Yelp
show_progress = False

Training Hyper Parameters:
checkpoint_dir = saved
epochs = 500
train_batch_size = 1024
learner = adam
learning_rate = 0.001
training_neg_sample_num = 0
training_neg_sample_distribution = uniform
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 1e-06
draw_loss_pic = False
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_setting = RO_RS,full
group_by_user = True
split_ratio = [0.8, 0.1, 0.1]
leave_one_num = 2
real_time_process = False
metrics = ['Recall', 'NDCG']
topk = [10, 20, 50]
valid_metric = NDCG@20
eval_batch_size = 4096
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = rating
TIME_FIELD = timestamp
seq_len = None
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'timestamp']}
unload_col = None
unused_col = None
additional_feat_suffix = None
lowest_val = None
highest_val = None
equal_val = None
not_equal_val = None
max_user_inter_num = None
min_user_inter_num = 5
max_item_inter_num = None
min_item_inter_num = 5
fields_in_same_space = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id

Other Hyper Parameters: 
valid_metric_bigger = True
BT = 0.1
bt = 0.001
embedding_size = 64
encoder = MF
gamma = 0.5
times = 1
witem = 0.1
wuser = 0.8
zc = 0.5
rm_dup_inter = None
filter_inter_by_user_or_item = True
SOURCE_ID_FIELD = source_id
TARGET_ID_FIELD = target_id
benchmark_filename = None
MODEL_TYPE = ModelType.GENERAL
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
device = cuda
train_neg_sample_args = {'strategy': 'none'}


20 Oct 20:44    INFO  Yelp
The number of users: 31669
Average actions of users: 49.305481874447395
The number of items: 38049
Average actions of items: 41.037794365012616
The number of inters: 1561406
The sparsity of the dataset: 99.87041991912021%
Remain Fields: ['user_id', 'item_id']
20 Oct 20:44    INFO  Build [GeneralDataLoader] for [train] with format [InputType.POINTWISE]
20 Oct 20:44    INFO  [train] No Negative Sampling
20 Oct 20:44    INFO  [train] batch_size = [1024], shuffle = [True]

20 Oct 20:44    INFO  Build [GeneralFullDataLoader] for [evaluation] with format [InputType.POINTWISE]
20 Oct 20:44    INFO  Evaluation Setting:
	Group by user_id
	Ordering: {'strategy': 'shuffle'}
	Splitting: {'strategy': 'by_ratio', 'ratios': [0.8, 0.1, 0.1]}
	Negative Sampling: {'strategy': 'full', 'distribution': 'uniform'}
20 Oct 20:44    INFO  [evaluation] batch_size = [4096], shuffle = [False]

20 Oct 20:44    WARNING  Batch size is changed to 38049.
20 Oct 20:44    WARNING  Batch size is changed to 38049.
{'BT': 0.1, 'bt': 0.001, 'embedding_size': 64, 'encoder': 'MF', 'gamma': None, 'times': 1, 'training_neg_sample_num': 0, 'witem': 0.1, 'wuser': 0.8, 'zc': 0.5}
this is encoder MF...
这是directau 的 WUBT 版本...
20 Oct 20:44    INFO  DirectAU(
  (encoder): MFEncoder(
    (user_embedding): Embedding(31669, 64)
    (item_embedding): Embedding(38049, 64)
  )
  (bn): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
  (projector): Sequential(
    (0): Linear(in_features=64, out_features=64, bias=False)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Linear(in_features=64, out_features=64, bias=False)
    (4): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Linear(in_features=64, out_features=64, bias=False)
  )
)
Trainable parameters: 4474496
20 Oct 20:44    INFO  epoch 0 training [time: 25.27s, train loss: -1.6170]
20 Oct 20:45    INFO  epoch 0 evaluating [time: 15.39s, valid_score: 0.020100]
20 Oct 20:45    INFO  valid result: 
recall@10 : 0.0189    recall@20 : 0.0346    recall@50 : 0.0732    ndcg@10 : 0.0146    ndcg@20 : 0.0201    ndcg@50 : 0.0316    
20 Oct 20:45    INFO  Saving current best: saved/DirectAU-Oct-20-2023_20-44-21.pth
20 Oct 20:45    INFO  epoch 1 training [time: 25.09s, train loss: -2.0701]
20 Oct 20:45    INFO  epoch 1 evaluating [time: 15.23s, valid_score: 0.025900]
20 Oct 20:45    INFO  valid result: 
recall@10 : 0.0244    recall@20 : 0.0444    recall@50 : 0.089    ndcg@10 : 0.0189    ndcg@20 : 0.0259    ndcg@50 : 0.039    
20 Oct 20:45    INFO  Saving current best: saved/DirectAU-Oct-20-2023_20-44-21.pth
20 Oct 20:46    INFO  epoch 2 training [time: 25.04s, train loss: -2.1429]
20 Oct 20:46    INFO  epoch 2 evaluating [time: 15.51s, valid_score: 0.028800]
20 Oct 20:46    INFO  valid result: 
recall@10 : 0.0278    recall@20 : 0.0487    recall@50 : 0.0964    ndcg@10 : 0.0216    ndcg@20 : 0.0288    ndcg@50 : 0.0428    
20 Oct 20:46    INFO  Saving current best: saved/DirectAU-Oct-20-2023_20-44-21.pth
20 Oct 20:46    INFO  epoch 3 training [time: 25.10s, train loss: -2.1800]
20 Oct 20:47    INFO  epoch 3 evaluating [time: 15.41s, valid_score: 0.030600]
20 Oct 20:47    INFO  valid result: 
recall@10 : 0.0301    recall@20 : 0.0519    recall@50 : 0.1033    ndcg@10 : 0.0231    ndcg@20 : 0.0306    ndcg@50 : 0.0456    
20 Oct 20:48    INFO  Saving current best: saved/DirectAU-Oct-20-2023_20-44-21.pth
20 Oct 20:48    INFO  epoch 4 training [time: 24.93s, train loss: -2.2113]
20 Oct 20:48    INFO  epoch 4 evaluating [time: 15.22s, valid_score: 0.032600]
20 Oct 20:48    INFO  valid result: 
recall@10 : 0.0312    recall@20 : 0.0551    recall@50 : 0.1077    ndcg@10 : 0.0244    ndcg@20 : 0.0326    ndcg@50 : 0.0479    
20 Oct 20:50    INFO  Saving current best: saved/DirectAU-Oct-20-2023_20-44-21.pth
20 Oct 20:51    INFO  epoch 5 training [time: 25.00s, train loss: -2.2274]
20 Oct 20:51    INFO  epoch 5 evaluating [time: 15.53s, valid_score: 0.034700]
20 Oct 20:51    INFO  valid result: 
recall@10 : 0.0336    recall@20 : 0.0581    recall@50 : 0.1126    ndcg@10 : 0.0263    ndcg@20 : 0.0347    ndcg@50 : 0.0505    
20 Oct 20:53    INFO  Saving current best: saved/DirectAU-Oct-20-2023_20-44-21.pth
20 Oct 20:53    INFO  epoch 6 training [time: 24.91s, train loss: -2.2411]
20 Oct 20:54    INFO  epoch 6 evaluating [time: 15.20s, valid_score: 0.036700]
20 Oct 20:54    INFO  valid result: 
recall@10 : 0.0356    recall@20 : 0.0616    recall@50 : 0.1163    ndcg@10 : 0.0279    ndcg@20 : 0.0367    ndcg@50 : 0.0526    
20 Oct 20:55    INFO  Saving current best: saved/DirectAU-Oct-20-2023_20-44-21.pth
20 Oct 20:55    INFO  epoch 7 training [time: 25.03s, train loss: -2.2562]
20 Oct 20:56    INFO  epoch 7 evaluating [time: 15.62s, valid_score: 0.037700]
20 Oct 20:56    INFO  valid result: 
recall@10 : 0.0381    recall@20 : 0.0632    recall@50 : 0.1196    ndcg@10 : 0.0292    ndcg@20 : 0.0377    ndcg@50 : 0.0541    
20 Oct 20:56    INFO  Saving current best: saved/DirectAU-Oct-20-2023_20-44-21.pth
20 Oct 20:56    INFO  epoch 8 training [time: 24.97s, train loss: -2.2678]
20 Oct 20:56    INFO  epoch 8 evaluating [time: 15.26s, valid_score: 0.039100]
20 Oct 20:56    INFO  valid result: 
recall@10 : 0.0391    recall@20 : 0.0648    recall@50 : 0.1244    ndcg@10 : 0.0304    ndcg@20 : 0.0391    ndcg@50 : 0.0564    
20 Oct 20:56    INFO  Saving current best: saved/DirectAU-Oct-20-2023_20-44-21.pth
20 Oct 20:57    INFO  epoch 9 training [time: 25.11s, train loss: -2.2755]
20 Oct 20:57    INFO  epoch 9 evaluating [time: 15.50s, valid_score: 0.040500]
20 Oct 20:57    INFO  valid result: 
recall@10 : 0.0403    recall@20 : 0.0672    recall@50 : 0.1273    ndcg@10 : 0.0314    ndcg@20 : 0.0405    ndcg@50 : 0.0581    
20 Oct 20:57    INFO  Saving current best: saved/DirectAU-Oct-20-2023_20-44-21.pth
20 Oct 20:57    INFO  epoch 10 training [time: 25.12s, train loss: -2.2803]
20 Oct 20:58    INFO  epoch 10 evaluating [time: 15.39s, valid_score: 0.042100]
20 Oct 20:58    INFO  valid result: 
recall@10 : 0.0411    recall@20 : 0.0696    recall@50 : 0.1304    ndcg@10 : 0.0325    ndcg@20 : 0.0421    ndcg@50 : 0.0598    
20 Oct 20:58    INFO  Saving current best: saved/DirectAU-Oct-20-2023_20-44-21.pth
20 Oct 20:58    INFO  epoch 11 training [time: 25.14s, train loss: -2.2896]
20 Oct 20:58    INFO  epoch 11 evaluating [time: 15.51s, valid_score: 0.042500]
20 Oct 20:58    INFO  valid result: 
recall@10 : 0.0422    recall@20 : 0.0705    recall@50 : 0.1317    ndcg@10 : 0.0329    ndcg@20 : 0.0425    ndcg@50 : 0.0603    
20 Oct 20:59    INFO  Saving current best: saved/DirectAU-Oct-20-2023_20-44-21.pth
20 Oct 21:00    INFO  epoch 12 training [time: 25.00s, train loss: -2.2975]
20 Oct 21:00    INFO  epoch 12 evaluating [time: 15.32s, valid_score: 0.043800]
20 Oct 21:00    INFO  valid result: 
recall@10 : 0.0429    recall@20 : 0.0724    recall@50 : 0.1348    ndcg@10 : 0.0337    ndcg@20 : 0.0438    ndcg@50 : 0.0618    
20 Oct 21:02    INFO  Saving current best: saved/DirectAU-Oct-20-2023_20-44-21.pth
20 Oct 21:03    INFO  epoch 13 training [time: 25.09s, train loss: -2.3012]
20 Oct 21:03    INFO  epoch 13 evaluating [time: 15.52s, valid_score: 0.043900]
20 Oct 21:03    INFO  valid result: 
recall@10 : 0.0439    recall@20 : 0.0726    recall@50 : 0.1357    ndcg@10 : 0.0341    ndcg@20 : 0.0439    ndcg@50 : 0.0622    
20 Oct 21:05    INFO  Saving current best: saved/DirectAU-Oct-20-2023_20-44-21.pth
20 Oct 21:05    INFO  epoch 14 training [time: 25.01s, train loss: -2.3049]
20 Oct 21:05    INFO  epoch 14 evaluating [time: 15.31s, valid_score: 0.044600]
20 Oct 21:05    INFO  valid result: 
recall@10 : 0.0445    recall@20 : 0.074    recall@50 : 0.1368    ndcg@10 : 0.0346    ndcg@20 : 0.0446    ndcg@50 : 0.0628    
20 Oct 21:07    INFO  Saving current best: saved/DirectAU-Oct-20-2023_20-44-21.pth
20 Oct 21:08    INFO  epoch 15 training [time: 24.97s, train loss: -2.3057]
20 Oct 21:08    INFO  epoch 15 evaluating [time: 16.77s, valid_score: 0.044500]
20 Oct 21:08    INFO  valid result: 
recall@10 : 0.044    recall@20 : 0.074    recall@50 : 0.1376    ndcg@10 : 0.0344    ndcg@20 : 0.0445    ndcg@50 : 0.0629    
20 Oct 21:08    INFO  epoch 16 training [time: 25.01s, train loss: -2.3070]
20 Oct 21:09    INFO  epoch 16 evaluating [time: 16.16s, valid_score: 0.044900]
20 Oct 21:09    INFO  valid result: 
recall@10 : 0.0449    recall@20 : 0.0745    recall@50 : 0.138    ndcg@10 : 0.0349    ndcg@20 : 0.0449    ndcg@50 : 0.0634    
20 Oct 21:10    INFO  Saving current best: saved/DirectAU-Oct-20-2023_20-44-21.pth
20 Oct 21:10    INFO  epoch 17 training [time: 25.02s, train loss: -2.3119]
20 Oct 21:11    INFO  epoch 17 evaluating [time: 16.56s, valid_score: 0.044700]
20 Oct 21:11    INFO  valid result: 
recall@10 : 0.0442    recall@20 : 0.0745    recall@50 : 0.1387    ndcg@10 : 0.0345    ndcg@20 : 0.0447    ndcg@50 : 0.0634    
20 Oct 21:11    INFO  epoch 18 training [time: 25.00s, train loss: -2.3146]
20 Oct 21:11    INFO  epoch 18 evaluating [time: 16.70s, valid_score: 0.045600]
20 Oct 21:11    INFO  valid result: 
recall@10 : 0.0448    recall@20 : 0.0756    recall@50 : 0.1395    ndcg@10 : 0.0352    ndcg@20 : 0.0456    ndcg@50 : 0.0641    
20 Oct 21:13    INFO  Saving current best: saved/DirectAU-Oct-20-2023_20-44-21.pth
20 Oct 21:13    INFO  epoch 19 training [time: 25.04s, train loss: -2.3181]
20 Oct 21:13    INFO  epoch 19 evaluating [time: 16.60s, valid_score: 0.045500]
20 Oct 21:13    INFO  valid result: 
recall@10 : 0.0453    recall@20 : 0.0754    recall@50 : 0.1393    ndcg@10 : 0.0353    ndcg@20 : 0.0455    ndcg@50 : 0.0639    
20 Oct 21:14    INFO  epoch 20 training [time: 25.04s, train loss: -2.3179]
20 Oct 21:14    INFO  epoch 20 evaluating [time: 16.85s, valid_score: 0.045300]
20 Oct 21:14    INFO  valid result: 
recall@10 : 0.0449    recall@20 : 0.0749    recall@50 : 0.1398    ndcg@10 : 0.0351    ndcg@20 : 0.0453    ndcg@50 : 0.064    
20 Oct 21:14    INFO  epoch 21 training [time: 25.08s, train loss: -2.3192]
20 Oct 21:15    INFO  epoch 21 evaluating [time: 15.64s, valid_score: 0.045500]
20 Oct 21:15    INFO  valid result: 
recall@10 : 0.0448    recall@20 : 0.0752    recall@50 : 0.1397    ndcg@10 : 0.0352    ndcg@20 : 0.0455    ndcg@50 : 0.0641    
20 Oct 21:15    INFO  epoch 22 training [time: 25.10s, train loss: -2.3240]
20 Oct 21:15    INFO  epoch 22 evaluating [time: 16.84s, valid_score: 0.044800]
20 Oct 21:15    INFO  valid result: 
recall@10 : 0.0445    recall@20 : 0.0741    recall@50 : 0.1381    ndcg@10 : 0.0348    ndcg@20 : 0.0448    ndcg@50 : 0.0634    
20 Oct 21:16    INFO  epoch 23 training [time: 25.19s, train loss: -2.3235]
20 Oct 21:16    INFO  epoch 23 evaluating [time: 16.53s, valid_score: 0.045400]
20 Oct 21:16    INFO  valid result: 
recall@10 : 0.0451    recall@20 : 0.0754    recall@50 : 0.1394    ndcg@10 : 0.0351    ndcg@20 : 0.0454    ndcg@50 : 0.0639    
20 Oct 21:17    INFO  epoch 24 training [time: 25.16s, train loss: -2.3222]
20 Oct 21:17    INFO  epoch 24 evaluating [time: 16.20s, valid_score: 0.045000]
20 Oct 21:17    INFO  valid result: 
recall@10 : 0.0448    recall@20 : 0.075    recall@50 : 0.1382    ndcg@10 : 0.0348    ndcg@20 : 0.045    ndcg@50 : 0.0633    
20 Oct 21:17    INFO  epoch 25 training [time: 25.14s, train loss: -2.3260]
20 Oct 21:17    INFO  epoch 25 evaluating [time: 16.42s, valid_score: 0.044800]
20 Oct 21:17    INFO  valid result: 
recall@10 : 0.0446    recall@20 : 0.0742    recall@50 : 0.1389    ndcg@10 : 0.0347    ndcg@20 : 0.0448    ndcg@50 : 0.0635    
20 Oct 21:18    INFO  epoch 26 training [time: 25.03s, train loss: -2.3248]
20 Oct 21:18    INFO  epoch 26 evaluating [time: 16.61s, valid_score: 0.044600]
20 Oct 21:18    INFO  valid result: 
recall@10 : 0.0439    recall@20 : 0.0741    recall@50 : 0.1386    ndcg@10 : 0.0344    ndcg@20 : 0.0446    ndcg@50 : 0.0633    
20 Oct 21:19    INFO  epoch 27 training [time: 25.12s, train loss: -2.3269]
20 Oct 21:19    INFO  epoch 27 evaluating [time: 16.47s, valid_score: 0.045000]
20 Oct 21:19    INFO  valid result: 
recall@10 : 0.0447    recall@20 : 0.0744    recall@50 : 0.1382    ndcg@10 : 0.0349    ndcg@20 : 0.045    ndcg@50 : 0.0635    
20 Oct 21:19    INFO  epoch 28 training [time: 25.13s, train loss: -2.3239]
20 Oct 21:20    INFO  epoch 28 evaluating [time: 16.01s, valid_score: 0.045000]
20 Oct 21:20    INFO  valid result: 
recall@10 : 0.0443    recall@20 : 0.0748    recall@50 : 0.1385    ndcg@10 : 0.0347    ndcg@20 : 0.045    ndcg@50 : 0.0634    
20 Oct 21:20    INFO  epoch 29 training [time: 25.09s, train loss: -2.3301]
20 Oct 21:20    INFO  epoch 29 evaluating [time: 15.86s, valid_score: 0.044800]
20 Oct 21:20    INFO  valid result: 
recall@10 : 0.0437    recall@20 : 0.0742    recall@50 : 0.1379    ndcg@10 : 0.0344    ndcg@20 : 0.0448    ndcg@50 : 0.0632    
20 Oct 21:20    INFO  Finished training, best eval result in epoch 18
20 Oct 21:20    INFO  Loading model structure and parameters from saved/DirectAU-Oct-20-2023_20-44-21.pth
20 Oct 21:20    INFO  best valid : {'recall@10': 0.0448, 'recall@20': 0.0756, 'recall@50': 0.1395, 'ndcg@10': 0.0352, 'ndcg@20': 0.0456, 'ndcg@50': 0.0641}
20 Oct 21:20    INFO  test result: {'recall@10': 0.0451, 'recall@20': 0.0746, 'recall@50': 0.138, 'ndcg@10': 0.0363, 'ndcg@20': 0.0462, 'ndcg@50': 0.0645}
